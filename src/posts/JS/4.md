---
icon: pen-to-square
cover: /assets/images/JS.png
category:
  - JS
tag:
  - JS技巧
  - 手写题
---

# js手写题（更新中）

## 模拟实现new操作符
```js
function myNew (constructor, ...args) {
  // 1. 创建一个空对象，并将其原型指向构造函数的原型
  let obj = Object.create(constructor.prototype);
  // 2. 将构造函数的this绑定到这个空对象，并执行构造函数的代码
  let result = constructor.apply(obj, args);
  // 3. 如果构造函数返回了一个对象，那么返回这个对象，否则返回创建的空对象
  return result instanceof Object ? result : obj;
}
// 定义一个构造函数
function Person (name, age) {
  this.name = name;
  this.age = age;
}

// 使用myNew来创建一个Person的实例
let p = myNew(Person, 'Tom', 18);

// 打印p的属性
console.log(p.name); // Tom
console.log(p.age); // 18
//至此成功用myNew来替代new操作符
```

## 柯里化函数
一个柯里化函数的基本思路是：

定义一个函数，接收一个原始函数和一个初始参数数组作为参数。

返回一个新函数，接收剩余的参数作为参数。

在新函数内部，将初始参数数组和剩余参数数组合并为一个完整的参数数组。

如果完整的参数数组的长度小于原始函数的形参个数，说明还需要继续传入参数，那么就递归调用自身，继续返回新函数，并保留当前的参数数组。

如果完整的参数数组的长度等于或大于原始函数的形参个数，说明已经传入了足够的参数，那么就调用原始函数，并将完整的参数数组作为实参传入，返回最终的结果。
```js
// 定义一个通用的柯里化函数
function curry(fn, args) {
  // 获取原始函数的形参个数
  var length = fn.length;
  // 如果没有传入初始参数数组，就默认为空数组
  var args = args || [];
  // 返回一个新函数
  return function() {
    // 将初始参数数组和剩余参数数组合并为一个完整的参数数组
    var newArgs = args.concat(Array.prototype.slice.call(arguments));
    // 如果完整的参数数组的长度小于原始函数的形参个数，说明还需要继续传入参数
    if (newArgs.length < length) {
      // 递归调用自身，继续返回新函数，并保留当前的参数数组
      return curry.call(this, fn, newArgs);
    } else {
      // 如果完整的参数数组的长度等于或大于原始函数的形参个数，说明已经传入了足够的参数
      // 调用原始函数，并将完整的参数数组作为实参传入，返回最终的结果
      return fn.apply(this, newArgs);
    }
  };
}
```

